<!DOCTYPE html>
<html>
<head>
	<!-- <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script> -->

	<meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Angular Material style sheet -->
  <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css">

  <!-- Angular Material requires Angular.js Libraries -->
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-animate.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-cookies.min.js"></script>

  <!-- Angular Material Library -->
  <script src="http://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.js"></script>

  <!-- Moment Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>

  <script src="motogp.js"></script>
  <link rel="stylesheet" href="style.css">

  <title>MotoGP Predictor Game</title>
</head>

<body>

<div ng-app="motogpApp" ng-controller="motogpCtrl" ng-cloak ng-show="initialized" ng-init="init()">
<!-- <md-content layout-padding flex> -->

<md-content layout="column" id="login" ng-show="!loggedIn" layout-padding flex>
	<!-- <p>Email: <input type="text" ng-model="username"></p>
	<p>Password: <input type="password" ng-model="password"></p> -->

	<center>
		<h2>Welcome to the MotoGP Predictor!</h2>

		<p>Please sign in</p>
	</center>
	
	<md-input-container>
    <label>Email</label>
    <input ng-model="username" type="text">
  </md-input-container>
  <md-input-container>
    <label>Password</label>
    <input ng-model="password" type="password">
  </md-input-container>

	<md-button class="md-raised md-primary" ng-click="login()">Sign in</md-button>
	<center>
		<p class="md-caption">
			Email <a href="mailto:samerf@gmail.com">samerf@gmail.com</a> to create an account.
		</p>
	</center>
</md-content>
<div id="data" ng-show="loggedIn">
<md-tabs class="md-accent" md-dynamic-height>
<md-tab label="Prediction">
<md-content layout-padding>
	<h2>Welcome {{user.name}}</h2>
	<p>
		Enter your predictions for the upcoming race below.
	</p>
	<div md-whiteframe="1" layout-padding class="race-box">
		<span class="md-title">{{predictionRace.location}}</span>
		<br>
		<span class="md-caption">Qualifying on {{predictionRace.qualifying_start_time_str}}</span>
		<br>
		<span class="md-caption">Race on {{predictionRace.race_start_time_str}}</span>
		<table>
			<tr>
				<td class="md-caption">Pole</td>
				<td>
					<select name="riderSelect" ng-model="predictionRace.selected_pole" ng-disabled="checkExpired(predictionRace.qualifying_start_time)">
			      <option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</option>
			    </select>
		    </td>
		    <td class="md-caption" ng-class="{green: predictionRace.pole === predictionRace.selected_pole, red: predictionRace.pole != predictionRace.selected_pole}">
		    	{{predictionRace.pole}}
		    </td>
    	</tr>
    	<tr>
				<td class="md-caption">First</td>
				<td>
					<md-select name="riderSelect" ng-model="predictionRace.selected_race_pos_1" ng-disabled="checkExpired(predictionRace.race_start_time)">
			      <md-option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</md-option>
			    </md-select>
		    </td>
		    <td class="md-caption" ng-class="{green: predictionRace.race_pos_1 === predictionRace.selected_race_pos_1, red: predictionRace.race_pos_1 != predictionRace.selected_race_pos_1}">
		    	{{predictionRace.race_pos_1}}
		    </td>
    	</tr>
    	<tr>
				<td class="md-caption">Second</td>
				<td>
					<md-select name="riderSelect" ng-model="predictionRace.selected_race_pos_2" ng-disabled="checkExpired(predictionRace.race_start_time)">
			      <md-option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</md-option>
			    </md-select>
		    </td>
		    <td class="md-caption" ng-class="{green: predictionRace.race_pos_2 === predictionRace.selected_race_pos_2, red: predictionRace.race_pos_2 != predictionRace.selected_race_pos_2}">
		    	{{predictionRace.race_pos_2}}
		    </td>
    	</tr>
    	<tr>
				<td class="md-caption">Third</td>
				<td>
					<md-select name="riderSelect" ng-model="predictionRace.selected_race_pos_3" ng-disabled="checkExpired(predictionRace.race_start_time)">
			      <md-option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</md-option>
			    </md-select>
		    </td>
		    <td class="md-caption" ng-class="{green: predictionRace.race_pos_3 === predictionRace.selected_race_pos_3, red: predictionRace.race_pos_3 != predictionRace.selected_race_pos_3}">
		    	{{predictionRace.race_pos_3}}
		    </td>
    	</tr>
    </table>
	</div>

	<br>

	<div layout="row" layout-align="center center">
		<md-button class="md-raised md-primary" ng-click="postPredictions()">Post Predictions</md-button>
	</div>
</md-content>
</md-tab>
<md-tab label="Results">
<md-content layout-padding>
<!-- <div id="data" ng-show="loggedIn"> -->
	<p>
		Your results for all completed races will show up below.
	</p>

	<div ng-repeat="race in races" md-whiteframe="1" layout-padding class="race-box" ng-show="checkExpired(race.qualifying_start_time) && checkExpired(race.race_start_time)">
		<span class="md-title">{{race.location}}</span>
		<br>
		<span class="md-caption">Qualifying on {{race.qualifying_start_time_str}}</span>
		<br>
		<span class="md-caption">Race on {{race.race_start_time_str}}</span>
		<table>
			<tr>
				<td class="md-caption">Pole</td>
				<td>
					<md-select name="riderSelect" ng-model="race.selected_pole" ng-disabled="checkExpired(race.qualifying_start_time)">
			      <md-option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</md-option>
			    </md-select>
		    </td>
		    <td class="md-caption" ng-class="{green: race.pole === race.selected_pole, red: race.pole != race.selected_pole}">
		    	{{race.pole}}
		    </td>
    	</tr>
    	<tr>
				<td class="md-caption">First</td>
				<td>
					<md-select name="riderSelect" ng-model="race.selected_race_pos_1" ng-disabled="checkExpired(race.race_start_time)">
			      <md-option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</md-option>
			    </md-select>
		    </td>
		    <td class="md-caption" ng-class="{green: race.race_pos_1 === race.selected_race_pos_1, red: race.race_pos_1 != race.selected_race_pos_1}">
		    	{{race.race_pos_1}}
		    </td>
    	</tr>
    	<tr>
				<td class="md-caption">Second</td>
				<td>
					<md-select name="riderSelect" ng-model="race.selected_race_pos_2" ng-disabled="checkExpired(race.race_start_time)">
			      <md-option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</md-option>
			    </md-select>
		    </td>
		    <td class="md-caption" ng-class="{green: race.race_pos_2 === race.selected_race_pos_2, red: race.race_pos_2 != race.selected_race_pos_2}">
		    	{{race.race_pos_2}}
		    </td>
    	</tr>
    	<tr>
				<td class="md-caption">Third</td>
				<td>
					<md-select name="riderSelect" ng-model="race.selected_race_pos_3" ng-disabled="checkExpired(race.race_start_time)">
			      <md-option ng-repeat="option in riders" value="{{option.name}}">{{option.name + ' (' + option.number + ')'}}</md-option>
			    </md-select>
		    </td>
		    <td class="md-caption" ng-class="{green: race.race_pos_3 === race.selected_race_pos_3, red: race.race_pos_3 != race.selected_race_pos_3}">
		    	{{race.race_pos_3}}
		    </td>
    	</tr>
    </table>
    <!-- <md-divider ng-if="!$last"></md-divider> -->
	</div>

	<!-- <br>

	<div layout="row" layout-align="center center">
		<md-button class="md-raised md-primary" ng-click="postPredictions()">Post Predictions</md-button>
	</div> -->

<!-- </div> -->
</md-content>
</md-tab>
<md-tab label="Scores">

<table>

<tr>
	<td></td>
	<td ng-repeat="user in scores.users">{{user}}</td>
<tr>
<tr ng-repeat="race in scores.races">
	<td>{{race}}</td>
	<td ng-repeat="score in scores[race]" ng-click="showScoreDialog($event, score)">{{score.score}}</td>
</tr>

</table>

<div style="visibility: hidden">
  <div class="md-dialog-container" id="scoreDialog">
    <md-dialog layout-padding>
	    <span class="md-title">{{scoreDialogElement.user}}</span>
			<br>
			<span class="md-caption">{{scoreDialogElement.location}}</span>
      <p>
      	<span>Predictions</span><br>
      	<span>Pole - {{scoreDialogElement.prediction.pole}}</span><br>
      	<span>1st - {{scoreDialogElement.prediction.race_pos_1}}</span><br>
      	<span>2nd - {{scoreDialogElement.prediction.race_pos_2}}</span><br>
      	<span>3rd - {{scoreDialogElement.prediction.race_pos_3}}</span><br>
      	<br>
      	<span>Actual</span><br>
      	<span>Pole - {{scoreDialogElement.results.pole}}</span><br>
      	<span>1st - {{scoreDialogElement.results.race_pos_1}}</span><br>
      	<span>2nd - {{scoreDialogElement.results.race_pos_2}}</span><br>
      	<span>3rd - {{scoreDialogElement.results.race_pos_3}}</span><br>
      </p>
    </md-dialog>
  </div>
</div>

</md-tab>
</md-tabs>
</div>
<!-- </md-content> -->
</div>

</body>
</html>